
WebWaka Suite POS ‚Äî Control Layer (Headless, No UI)

‚∏ª

CONTEXT

You are operating as Replit AI on behalf of the WebWaka Modular Rebuild.

This task is governed by the WebWaka Ecosystem Constitution (v1.6) and all prior ratified amendments.

This is a STRICT IMPLEMENTATION TASK.

‚∏ª

üîí NON-NEGOTIABLE PRE-CHECK (MANDATORY)

STEP 0 ‚Äî REPOSITORY VERIFICATION (HARD REQUIREMENT)

Before writing any code, you MUST:
	1.	Clone the GitHub repository:

https://github.com/changerplanet/webwaka-suite-pos-control

	2.	Verify ALL of the following:
	‚Ä¢	Repo exists
	‚Ä¢	Default branch = main
	‚Ä¢	Mandatory governance files are present
	‚Ä¢	CI passes in current state

‚ùå If the repo does NOT exist
‚ùå If cloning fails
‚ùå If governance files are missing

‚û°Ô∏è STOP IMMEDIATELY
‚û°Ô∏è Respond with:

‚ÄúBLOCKED: Required repository substrate is missing or incomplete.‚Äù

‚ö†Ô∏è You are NOT allowed to create repos, rename repos, or improvise structure.

‚∏ª

üéØ PHASE 5A OBJECTIVE

Implement the POS Suite Control Layer as a pure, headless, deterministic library.

This module defines:
	‚Ä¢	POS-specific capabilities
	‚Ä¢	POS-specific entitlements
	‚Ä¢	POS-specific feature flags
	‚Ä¢	POS-specific dashboard sections (declarative only)

It does NOT implement:
	‚Ä¢	UI
	‚Ä¢	POS runtime logic
	‚Ä¢	Payments
	‚Ä¢	Inventory mutations
	‚Ä¢	Pricing calculations

‚∏ª

üì¶ MODULE SCOPE (STRICT)

YOU MUST IMPLEMENT:

1. POS Capability Definitions
Examples (non-exhaustive):
	‚Ä¢	pos:sale.create
	‚Ä¢	pos:sale.refund
	‚Ä¢	pos:shift.open
	‚Ä¢	pos:shift.close
	‚Ä¢	pos:inventory.view
	‚Ä¢	pos:reports.view

Capabilities must:
	‚Ä¢	Be declarative
	‚Ä¢	Be registered in module.manifest.json
	‚Ä¢	Be documented in module.contract.md

‚∏ª

2. POS Entitlement Definitions
Examples:
	‚Ä¢	pos-access
	‚Ä¢	pos-offline-enabled
	‚Ä¢	pos-multi-location
	‚Ä¢	pos-advanced-reports

Rules:
	‚Ä¢	No evaluation logic
	‚Ä¢	No pricing logic
	‚Ä¢	Definitions only
	‚Ä¢	Designed to be consumed by Core Entitlements

‚∏ª

3. POS Feature Flags
Examples:
	‚Ä¢	pos-enabled
	‚Ä¢	pos-offline-sales
	‚Ä¢	pos-cash-rounding
	‚Ä¢	pos-nigeria-vat

Rules:
	‚Ä¢	Flags are data only
	‚Ä¢	No experimentation logic
	‚Ä¢	Compatible with Core Feature Flags engine

‚∏ª

4. POS Dashboard Declaration (Consumer of Phase 4A)
Define a POS Tenant Dashboard Declaration:
	‚Ä¢	Sections (Sales, Shifts, Inventory, Reports, Settings)
	‚Ä¢	Each section gated by:
	‚Ä¢	Permissions
	‚Ä¢	Entitlements
	‚Ä¢	Feature flags

‚ö†Ô∏è ALL visibility resolution MUST be delegated to Phase 4A Dashboard Control Engine

‚∏ª

üß† ARCHITECTURAL LAWS (DO NOT VIOLATE)

You MUST respect:
	‚Ä¢	‚ùå No business logic
	‚Ä¢	‚ùå No role checks
	‚Ä¢	‚ùå No direct permission evaluation
	‚Ä¢	‚ùå No UI rendering
	‚Ä¢	‚ùå No environment access

You MUST ensure:
	‚Ä¢	‚úÖ Determinism (same input ‚Üí same output)
	‚Ä¢	‚úÖ Tenant isolation
	‚Ä¢	‚úÖ Pure data declarations
	‚Ä¢	‚úÖ JSON-serializable structures
	‚Ä¢	‚úÖ Snapshot compatibility

‚∏ª

üß™ TESTING REQUIREMENTS

You MUST implement tests that prove:
	1.	Capabilities are correctly declared
	2.	Entitlements are defined without logic
	3.	Feature flags are evaluable via Core engine
	4.	Dashboard declaration:
	‚Ä¢	Hides sections when permissions missing
	‚Ä¢	Hides sections when entitlements missing
	‚Ä¢	Hides sections when feature flags disabled
	5.	Determinism:
	‚Ä¢	10√ó repeated evaluations ‚Üí identical output

Coverage target:
	‚Ä¢	‚â• 80% statements

‚∏ª

üìÑ REQUIRED FILES (MINIMUM)

You MUST update or create:
	‚Ä¢	src/capabilities.ts
	‚Ä¢	src/entitlements.ts
	‚Ä¢	src/featureFlags.ts
	‚Ä¢	src/dashboard/pos.dashboard.ts
	‚Ä¢	module.manifest.json
	‚Ä¢	module.contract.md
	‚Ä¢	__tests__/*

‚∏ª

üö´ EXPLICIT EXCLUSIONS

You are NOT allowed to implement:
	‚Ä¢	POS UI
	‚Ä¢	POS runtime flows
	‚Ä¢	Payment logic
	‚Ä¢	Inventory mutation
	‚Ä¢	Ledger writes
	‚Ä¢	Offline sync engines

‚∏ª

üì¶ REQUIRED FINAL DELIVERABLE

Respond with a Phase 5A Completion Report containing:
	1.	List of capabilities defined
	2.	List of entitlements defined
	3.	List of feature flags defined
	4.	Dashboard sections + gating matrix
	5.	Test summary + coverage %
	6.	Final commit SHA on main

‚∏ª

‚õî HARD STOP

After submitting the completion report:

‚õî STOP
‚õî Do NOT proceed to Phase 5B
‚õî Await explicit authorization